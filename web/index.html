<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html >
    <head >
        <title>Hospital</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!--jquery-->
        <link rel="stylesheet" type="text/css" href="css/style1.css" />
        <link rel="stylesheet" href="css/loadingstyle.css">
        <link rel="stylesheet" type="text/css" href="css/frame1.css" />
        <script src="Javascript/canvasjs.min.js" type="text/javascript"></script>
        <script src="Javascript/GetDataFromFitbit.js" type="text/javascript"></script>

        <script src="Javascript/jquery.js" type="text/javascript"></script>
        <script src="Javascript/TextType2.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script>
            var check1 = 1;
            var check2 = 1;
            var check3 = 1;
            var check4 = 1;
            var check5 = 1;
            var finish1 = 1;
            var finish2 = 1;
            var finish3 = 1;
            var finish4 = 1;
            var finish5 = 1;
            window.onload = load();
            var Sum = 0;
            var Heart = 0;
            var Sleep = 0;
            var AcHeart = 0;
            var AcDetail = 0;
            var Sum2 = 0;
            var Heart2 = 0;
            var Sleep2 = 0;
            var AcHeart2 = 0;
            var AcDetail2 = 0;
            var delcheck1 = 1;
            var delcheck2 = 1;
            var delcheck3 = 1;
            var delcheck4 = 1;
            var delcheck5 = 1;
        </script>
        <script src="Javascript/SelectData.js" type="text/javascript"></script>
        <script src="Javascript/DeleteData.js" type="text/javascript"></script>
    </head>
    <body>
        <div class="container">
            <div class="selectdata">
                <div class="uniplatselect">
                    <font size="6" face="monospace" >Select Data From Uniplat 
                    </font>
                </div>
                <br>
                <font size="5" face="monospace" >Choose Table <BR></font >
                <font size="4" face="monospace" >
                <input type="checkbox" id="Summary" >Summary<BR>
                <input type="checkbox" id="HeartRate" >HeartRate<BR>
                <input type="checkbox" id="Sleep" >Sleep<BR>
                <input type="checkbox" id="ActivityHeart" >Activity_Heart<BR>
                <input type="checkbox" id="ActivityDetail" onclick='checkid()'>Activity_Detail<BR>
                <font  face="monospace" id="usertext2" style="display:inline"><br>User:</font >
                <select id="user2" >

                </select>
                <font id="actidtext" size="5" face="monospace" style="margin-left:20px; display:none ">Activity ID:</font >
                <select id="actid"  style="display:none">
                    <option>Choose A Item 
                    <option  value="calories">Calories
                    <option  value="steps">Steps
                    <option  value="distance">Distance
                    <option  value="floors">Floors
                    <option  value="elevation">Elevation
                </select>
                <font  face="monospace"  style="display:inline"><BR><BR>StartDate:</font>
                <input type="date" id="date" >
                <font  face="monospace"  style="display:inline"><BR><BR>EndDate:</font>
                <input type="date" id="date2" >

                <br><br>
                <input type="button" id="sub2" value="Submit" onclick="check();SelectData()">
                <a href="http://140.138.77.109/login.php"><input type="button" value="HOME"></a>
                <BR>
                <BR>


                <div class="datatype" id="Sumdatatype" style="display: none">
                    <div id="Sumloading"  >
                        <div class="k-letter-holder">
                            <div class="k-letter-1b k-letter">L</div>
                            <div class="k-letter-2b k-letter">o</div>
                            <div class="k-letter-3b k-letter">a</div>
                            <div class="k-letter-4b k-letter">d</div>
                            <div class="k-letter-5b k-letter">i</div>
                            <div class="k-letter-6b k-letter">n</div>
                            <div class="k-letter-7b k-letter">g</div>
                            <div class="k-letter-8b k-letter">.</div>
                            <div class="k-letter-9b k-letter">.</div>
                            <div class="k-letter-10b k-letter">.</div>
                        </div>
                    </div>
                    <br>
                    <font face="monospace" id="Sumdata">

                    </font>
                    <br>


                </div>
                <input id="SumCSV"type="button" style="display:none" value="匯出Sum的CSV" onclick="exportSum()">  
                <br>
                <div class="datatype" id="Heartdatatype" style="display: none">  
                    <div id="Heartloading"  >
                        <div class="k-letter-holder">
                            <div class="k-letter-1b k-letter">L</div>
                            <div class="k-letter-2b k-letter">o</div>
                            <div class="k-letter-3b k-letter">a</div>
                            <div class="k-letter-4b k-letter">d</div>
                            <div class="k-letter-5b k-letter">i</div>
                            <div class="k-letter-6b k-letter">n</div>
                            <div class="k-letter-7b k-letter">g</div>
                            <div class="k-letter-8b k-letter">.</div>
                            <div class="k-letter-9b k-letter">.</div>
                            <div class="k-letter-10b k-letter">.</div>
                        </div>
                    </div>
                    <br>
                    <font face="monospace" id="Heartdata">

                    </font>
                    <br>
                </div>
                <input id="HeartRateCSV"type="button" style="display:none" value="匯出HeartRate的CSV" onclick="exportHeartRate()"> 
                <br> 
                <div class="datatype" id="Sleepdatatype" style="display: none">
                    <div id="Sleeploading"  >
                        <div class="k-letter-holder">
                            <div class="k-letter-1b k-letter">L</div>
                            <div class="k-letter-2b k-letter">o</div>
                            <div class="k-letter-3b k-letter">a</div>
                            <div class="k-letter-4b k-letter">d</div>
                            <div class="k-letter-5b k-letter">i</div>
                            <div class="k-letter-6b k-letter">n</div>
                            <div class="k-letter-7b k-letter">g</div>
                            <div class="k-letter-8b k-letter">.</div>
                            <div class="k-letter-9b k-letter">.</div>
                            <div class="k-letter-10b k-letter">.</div>
                        </div>
                    </div>
                    <br>
                    <font face="monospace" id="Sleepdata">

                    </font>
                    <br>
                </div>
                <input id="SleepCSV"type="button" style="display:none" value="匯出Sleep的CSV" onclick="exportSleep()">
                <br>  
                <div class="datatype" id="ACHdatatype" style="display: none">
                    <div id="ACHloading"  >
                        <div class="k-letter-holder">
                            <div class="k-letter-1b k-letter">L</div>
                            <div class="k-letter-2b k-letter">o</div>
                            <div class="k-letter-3b k-letter">a</div>
                            <div class="k-letter-4b k-letter">d</div>
                            <div class="k-letter-5b k-letter">i</div>
                            <div class="k-letter-6b k-letter">n</div>
                            <div class="k-letter-7b k-letter">g</div>
                            <div class="k-letter-8b k-letter">.</div>
                            <div class="k-letter-9b k-letter">.</div>
                            <div class="k-letter-10b k-letter">.</div>
                        </div>
                    </div>
                    <br>
                    <font face="monospace" id="ACHdata">

                    </font>
                    <br>
                </div>
                <input id="ACHeartRateCSV"type="button" style="display:none" value="匯出AC_Heart的CSV" onclick="exportACHeart()"> 
                <br> 
                <div class="datatype" id="ACDdatatype" style="display: none">
                    <div id="ACDloading"  >
                        <div class="k-letter-holder">
                            <div class="k-letter-1b k-letter">L</div>
                            <div class="k-letter-2b k-letter">o</div>
                            <div class="k-letter-3b k-letter">a</div>
                            <div class="k-letter-4b k-letter">d</div>
                            <div class="k-letter-5b k-letter">i</div>
                            <div class="k-letter-6b k-letter">n</div>
                            <div class="k-letter-7b k-letter">g</div>
                            <div class="k-letter-8b k-letter">.</div>
                            <div class="k-letter-9b k-letter">.</div>
                            <div class="k-letter-10b k-letter">.</div>
                        </div>
                    </div>
                    <br>
                    <font face="monospace" id="ACDdata">

                    </font>

                </div>
                <input id="ACDetailCSV"type="button" style="display:none" value="匯出AC_Detail的CSV" onclick="exportACDetail()">                  
                <br>
            </div>

        </div>
        <div class="container2"style="position:absolute;top:0;right:20%;">
            <font size="6" face="monospace" >Delete Data From Uniplat 
            </font>

            <br>
            <font size="5" face="monospace" >Choose Table <BR></font >
            <font size="4" face="monospace" >
            <input type="checkbox" id="Summary2" >Summary<BR>
            <input type="checkbox" id="HeartRate2" >HeartRate<BR>
            <input type="checkbox" id="Sleep2" >Sleep<BR>
            <input type="checkbox" id="ActivityHeart2" >Activity_Heart<BR>
            <input type="checkbox" id="ActivityDetail2">Activity_Detail<BR>
            <font  face="monospace" id="usertext" style="display:inline"><br>User:</font >
            <select id="user" >

            </select>
            <font  face="monospace"  style="display:inline"><BR><BR>StartDate:</font>
            <input type="date" id="deldate" >
            <font  face="monospace"  style="display:inline"><BR><BR>EndDate:</font>
            <input type="date" id="deldate2" >
            <input type="button" id="delsub" value="Submit" onclick="if (confirm('確認刪除嗎?')) {
                        checkdel();
                        deletedata()
                    }"> 
            <div id="Deleteloading" style='display:none' >
                <div class="k-letter-holder">
                    <div class="k-letter-1b k-letter">L</div>
                    <div class="k-letter-2b k-letter">o</div>
                    <div class="k-letter-3b k-letter">a</div>
                    <div class="k-letter-4b k-letter">d</div>
                    <div class="k-letter-5b k-letter">i</div>
                    <div class="k-letter-6b k-letter">n</div>
                    <div class="k-letter-7b k-letter">g</div>
                    <div class="k-letter-8b k-letter">.</div>
                    <div class="k-letter-9b k-letter">.</div>
                    <div class="k-letter-10b k-letter">.</div>
                </div>
            </div>
            <br>
            <font face="monospace" id="Deletedata" style="font-size:10">

            </font>
        </div>
    </body>
    <script>
        function exportHeartRate() {

            var HeartRatelink = document.createElement("a");
            var HeartRatedatacsv = "";
            for (var i = 0; i < HeartRateCSVTableNew.rows.length; i++) {
                for (var j = 0; j < HeartRateCSVTableNew.rows[i].cells.length; j++) {
                    HeartRatedatacsv = HeartRatedatacsv.concat(jQuery.trim(HeartRateCSVTableNew.rows[i].cells[j].innerHTML) + (j == HeartRateCSVTableNew.rows[i].cells.length - 1 ? "\n" : ","));
                }
            }

            HeartRatelink.download = "HeartRate.csv";
            HeartRatelink.href = "data:text/csv;charset=utf-8;base64," + window.btoa(HeartRatedatacsv);
            HeartRatelink.click();
        }
    </script>  
    <script>
        function exportSum() {
            var Sumlink = document.createElement("a");
            var Sumdatacsv = "";
            for (var i = 0; i < SumCSVTable.rows.length; i++) {
                for (var j = 0; j < SumCSVTable.rows[i].cells.length; j++) {
                    Sumdatacsv = Sumdatacsv.concat(jQuery.trim(SumCSVTable.rows[i].cells[j].innerHTML) + (j == SumCSVTable.rows[i].cells.length - 1 ? "\n" : ","));
                }
            }

            Sumlink.download = "Summary.csv";
            Sumlink.href = "data:text/csv;charset=utf-8;base64," + window.btoa(Sumdatacsv);
            Sumlink.click();
        }
    </script>    
    <script>
        function exportSleep() {
            var Sleeplink = document.createElement("a");
            var Sleepdatacsv = "";
            for (var i = 0; i < SleepCSVTable.rows.length; i++) {
                for (var j = 0; j < SleepCSVTable.rows[i].cells.length; j++) {
                    Sleepdatacsv = Sleepdatacsv.concat(jQuery.trim(SleepCSVTable.rows[i].cells[j].innerHTML) + (j == SleepCSVTable.rows[i].cells.length - 1 ? "\n" : ","));
                }
            }

            Sleeplink.download = "Sleep.csv";
            Sleeplink.href = "data:text/csv;charset=utf-8;base64," + window.btoa(Sleepdatacsv);
            Sleeplink.click();
        }
    </script>  
    <script>
        function exportACHeart() {
            var ACHeartlink = document.createElement("a");
            var ACHeartdatacsv = "";
            for (var i = 0; i < ACHeartCSVTable.rows.length; i++) {
                for (var j = 0; j < ACHeartCSVTable.rows[i].cells.length; j++) {
                    ACHeartdatacsv = ACHeartdatacsv.concat(jQuery.trim(ACHeartCSVTable.rows[i].cells[j].innerHTML) + (j == ACHeartCSVTable.rows[i].cells.length - 1 ? "\n" : ","));
                }
            }

            ACHeartlink.download = "Activity_Heart.csv";
            ACHeartlink.href = "data:text/csv;charset=utf-8;base64," + window.btoa(ACHeartdatacsv);
            ACHeartlink.click();
        }
    </script>  
    <script>
        function exportACDetail() {
            var ACDetaillink = document.createElement("a");
            var ACDetaildatacsv = "";
            for (var i = 0; i < ACDetailCSVTable.rows.length; i++) {
                for (var j = 0; j < ACDetailCSVTable.rows[i].cells.length; j++) {
                    ACDetaildatacsv = ACDetaildatacsv.concat(jQuery.trim(ACDetailCSVTable.rows[i].cells[j].innerHTML) + (j == ACDetailCSVTable.rows[i].cells.length - 1 ? "\n" : ","));
                }
            }

            ACDetaillink.download = "Activity_Detail.csv";
            ACDetaillink.href = "data:text/csv;charset=utf-8;base64," + window.btoa(ACDetaildatacsv);
            ACDetaillink.click();
        }
    </script>  
</html>
